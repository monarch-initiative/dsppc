package org.monarchinitiative.dsppc;

import org.junit.BeforeClass;
import org.junit.Test;

import org.monarchinitiative.phenol.formats.hpo.HpoDisease;
import org.monarchinitiative.phenol.io.OntologyLoader;
import org.monarchinitiative.phenol.ontology.data.Ontology;
import org.monarchinitiative.phenol.ontology.data.TermId;

import java.io.File;
import java.io.IOException;
import java.util.*;

import static org.junit.Assert.*;
import static org.monarchinitiative.dsppc.Counter.*;
import static org.monarchinitiative.dsppc.Dsppc.*;

/* created 08 Feb 2019
 *
 */
public class CounterTest {
    private static Counter ctr;
    private static String dataDir = "src/main/resources/";
    private static List<TermId> allGenes;
    private static Map<TermId, HpoDisease> diseaseMap;
    private static Map<TermId, Set<TermId>> geneToDiseasesMap;
    private static Set<TermId> gpiAnchoredGenes = new TreeSet<>();
    private static Set<TermId> gpiPathwayGenes = new TreeSet<>();
    private static Ontology hpo;

    private static final int CARDINALITY = 5;

    @BeforeClass
    public static void setUp() throws Exception {
        allGenes = parseAllGenes(dataDir + ALL_GENES_FILENAME);
        hpo = OntologyLoader.loadOntology(new File(dataDir + HPO_FILENAME));
        diseaseMap = parseHPOA(dataDir + HPOA_FILENAME, hpo);
        geneToDiseasesMap = parseMedgen(dataDir + MIM2GENE_MEDGEN_FILENAME);
        parseGeneSets(dataDir + GENE_SETS_FILENAME, gpiPathwayGenes, gpiAnchoredGenes);
        allGenes.removeAll(gpiPathwayGenes);
        ctr = new Counter(allGenes, diseaseMap, geneToDiseasesMap);
    }

    /* from mim2gene_medgen:
     * 300151	293	gene	-	-	-
     * 403000	293	gene	-	-	-
     *
     * 120810	720	gene	-	-	-
     * 614374	720	phenotype	 GeneMap	C1292315	nondisease
     * 614380	720	phenotype	 GeneMap	C1852692	-
     *
     * 158375	4589	gene	-	-	-
     * 600807	4589	phenotype	 GeneMap	C1869116	susceptibility
     *
     * 612320	200008	gene	-	-	-
     * 107986818 does not appear in mim2gene_medgen
     *
     * 293 not a disease gene
     * 720 a disease gene with one disease (614380)
     * 4589 a disease gene with one disease (600807)
     * 200008 not a disease gene
     * 107986818 not a disease gene
     *
     * total: 2 disease genes, 2 diseases
     *
     * from phenotype.hpoa:
     * OMIM:614380	#614380 COMPLEMENT COMPONENT 4A DEFICIENCY; C4AD;;C4A DEFICIENCY		HP:0000099	OMIM:61438TAS					P	HPO:skoehler[2012-10-17]
     * OMIM:614380	#614380 COMPLEMENT COMPONENT 4A DEFICIENCY; C4AD;;C4A DEFICIENCY		HP:0002725	OMIM:61438TAS					P	HPO:skoehler[2012-10-17]
     * OMIM:614380	#614380 COMPLEMENT COMPONENT 4A DEFICIENCY; C4AD;;C4A DEFICIENCY		HP:0002633	OMIM:61438TAS					P	HPO:skoehler[2012-10-17]
     * OMIM:614380	#614380 COMPLEMENT COMPONENT 4A DEFICIENCY; C4AD;;C4A DEFICIENCY		HP:0000007	OMIM:61438TAS					I	HPO:skoehler[2012-10-17]
     * OMIM:614380	#614380 COMPLEMENT COMPONENT 4A DEFICIENCY; C4AD;;C4A DEFICIENCY		HP:0000992	OMIM:61438TAS					P	HPO:skoehler[2012-10-17]
     * OMIM:614380	#614380 COMPLEMENT COMPONENT 4A DEFICIENCY; C4AD;;C4A DEFICIENCY		HP:0000979	OMIM:61438TAS					P	HPO:skoehler[2016-03-31]
     * OMIM:614380	#614380 COMPLEMENT COMPONENT 4A DEFICIENCY; C4AD;;C4A DEFICIENCY		HP:0004431	OMIM:61438TAS					P	HPO:probinson[2013-12-15]
     *
     * OMIM:600807	ASTHMA, SUSCEPTIBILITY TO		HP:0002099	OMIM:600807	IEA					HPO:iea[2009-02-17]
     *
     * HP:0000007 Autosomal recessive inheritance is not a phenotypic abnormality
     *
     * total count of phenotypes = 6 + 1 = 7
     */

    @Test
    public void countOneSetTest() {
        Set<TermId> genes = new HashSet<>(CARDINALITY);
        genes.add(TermId.of("ENTREZ","293"));
        genes.add(TermId.of("ENTREZ","720"));
        genes.add(TermId.of("ENTREZ","4589"));
        genes.add(TermId.of("ENTREZ", "200008"));
        genes.add(TermId.of("ENTREZ", "107986818"));
        int[] counts = ctr.countOneSet(genes);
        assertEquals("NUM_DISEASE_GENES is " + counts[NUM_DISEASE_GENES] + ", should be 2.",
                2, counts[NUM_DISEASE_GENES]);
        assertEquals("NUM_DISEASES is " + counts[NUM_DISEASES] + ", should be 2.",
                2, counts[NUM_DISEASES]);
        assertEquals("NUM_PHENOTYES is " + counts[NUM_PHENOTYPES] + ", should be 7.",
                7, counts[NUM_PHENOTYPES]);
    }

    /* from mim2gene_medgen:
     * 114480	675	phenotype	 GeneMap; GeneReviews	C0006142	susceptibility
     * 155255	675	phenotype	 GeneMap	C0025149	susceptibility
     * 176807	675	phenotype	 GeneMap	C0376358	susceptibility
     * 194070	675	phenotype	 GeneMap	CN033288	-
     * 605724	675	phenotype	 GeneMap	C1838457	-
     * 612555	675	phenotype	 GeneMap	C2675520	susceptibility
     * 613029	675	phenotype	 GeneMap	C2751641	susceptibility
     * 613347	675	phenotype	 GeneMap	C3150546	susceptibility
     *
     * 105400	1639	phenotype	 GeneMap	C1862939	susceptibility
     * 168605	1639	phenotype	 GeneMap; GeneReviews	C1868594	-
     * 607641	1639	phenotype	 GeneMap; GeneReviews	C1843315	-
     *
     * 105400	4744	phenotype	 GeneMap	C1862939	susceptibility; question
     * 616924	4744	phenotype	 GeneMap	C4310790	-
     *
     * 105400	5630	phenotype	 GeneMap	C1862939	susceptibility
     *
     * 105400	6647	phenotype	 GeneMap	C1862939	-
     *
     * total: 5 disease genes, 12 diseases
     *
     * from phenotype.hpoa:
     *
     * OMIM:105400	AMYOTROPHIC LATERAL SCLEROSIS 1		HP:0000006	OMIM:105400	TAS					HPO:probinson[2012-04-11]
     * OMIM:105400	AMYOTROPHIC LATERAL SCLEROSIS 1		HP:0002380	OMIM:105400	TAS					HPO:probinson[2012-04-11]
     * OMIM:105400	AMYOTROPHIC LATERAL SCLEROSIS 1		HP:0003394	OMIM:105400	TAS					HPO:probinson[2012-04-11]
     * OMIM:105400	AMYOTROPHIC LATERAL SCLEROSIS 1		HP:0001324	OMIM:105400	TAS					HPO:probinson[2012-04-11]
     * OMIM:105400	AMYOTROPHIC LATERAL SCLEROSIS 1		HP:0003202	OMIM:105400	TAS					HPO:probinson[2012-04-11]
     * OMIM:105400	AMYOTROPHIC LATERAL SCLEROSIS 1		HP:0001347	OMIM:105400	TAS					HPO:probinson[2012-04-11]
     * OMIM:105400	AMYOTROPHIC LATERAL SCLEROSIS 1		HP:0007024	OMIM:105400	TAS					HPO:probinson[2012-04-11]
     * OMIM:105400	AMYOTROPHIC LATERAL SCLEROSIS 1		HP:0001260	OMIM:105400	TAS					HPO:probinson[2012-04-11]
     * OMIM:105400	AMYOTROPHIC LATERAL SCLEROSIS 1		HP:0002015	OMIM:105400	TAS					HPO:probinson[2012-04-11]
     * OMIM:105400	AMYOTROPHIC LATERAL SCLEROSIS 1		HP:0001257	OMIM:105400	TAS					HPO:probinson[2012-04-11]
     * OMIM:105400	AMYOTROPHIC LATERAL SCLEROSIS 1		HP:0002398	OMIM:105400	TAS					HPO:probinson[2012-04-11]
     * OMIM:105400	AMYOTROPHIC LATERAL SCLEROSIS 1		HP:0002314	OMIM:105400	TAS					HPO:probinson[2012-04-11]
     * OMIM:105400	AMYOTROPHIC LATERAL SCLEROSIS 1		HP:0000007	OMIM:105400	IEA					HPO:skoehler[2012-10-12]
     * OMIM:105400	AMYOTROPHIC LATERAL SCLEROSIS 1		HP:0001425	OMIM:105400	IEA					HPO:skoehler[2012-10-12]
     * OMIM:105400	AMYOTROPHIC LATERAL SCLEROSIS 1		HP:0010535	OMIM:105400	IEA					HPO:skoehler[2012-10-12]
     * OMIM:105400	AMYOTROPHIC LATERAL SCLEROSIS 1		HP:0007354	OMIM:105400	IEA					HPO:skoehler[2015-01-19]
     *
     * OMIM:114480	BREAST CANCER		HP:0000006	OMIM:114480	IEA					I	HPO:iea[2009-02-17]
     * OMIM:114480	BREAST CANCER		HP:0003002	OMIM:114480	IEA					P	HPO:iea[2009-02-17]
     * OMIM:114480	#114480 BREAST CANCER;;BREAST CANCER, FAMILIALBREAST CANCER, FAMILIAL MALE, INCLUDED
     * 		HP:0001425	OMIM:114480	TAS					I	HPO:skoehler[2012-10-17]
     *
     * OMIM:155255	MEDULLOBLASTOMA		HP:0000006	OMIM:155255	TAS					I	HPO:probinson[2009-02-17]
     * OMIM:155255	MEDULLOBLASTOMA		HP:0002885	OMIM:155255	TAS					P	HPO:probinson[2009-02-17]
     * OMIM:155255	MEDULLOBLASTOMA		HP:0000007	OMIM:155255	TAS					I	HPO:skoehler[2017-07-13]
     * OMIM:155255	MEDULLOBLASTOMA		HP:0003829	OMIM:155255	TAS					M	HPO:skoehler[2017-07-13]
     *
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0000006	OMIM:168605	IEA	HPO:iea[2009-02-17]
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0000298	OMIM:168605	IEA	HPO:iea[2009-02-17]
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0000716	OMIM:168605	TAS	HPO:skoehler[2009-02-17]
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0000716	OMIM:168605	IEA	HPO:skoehler[2010-06-18]
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0000741	OMIM:168605	IEA	HPO:iea[2009-02-17]
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0001260	OMIM:168605	IEA	HPO:iea[2009-02-17]
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0001300	OMIM:168605	IEA	HPO:iea[2009-02-17]
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0001337	OMIM:168605	IEA	HPO:iea[2009-02-17]
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0001621	OMIM:168605	IEA	HPO:iea[2009-02-17]
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0001824	OMIM:168605	TAS	HPO:skoehler[2010-06-18]
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0001939	OMIM:168605	IEA	HPO:iea[2009-02-17]
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0002063	OMIM:168605	IEA	HPO:iea[2009-02-17]
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0002067	OMIM:168605	IEA	HPO:iea[2009-02-17]
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0002093	OMIM:168605	IEA	HPO:iea[2009-02-17]
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0002360	OMIM:168605	IEA	HPO:iea[2009-02-17]
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0003678	OMIM:168605	TAS	HPO:skoehler[2010-06-19]
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0002791	OMIM:168605	IEA	HPO:iea[2009-02-17]
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0007110	OMIM:168605	TAS	HPO:skoehler[2010-06-20]
     * OMIM:168605	PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0007311	OMIM:168605	IEA	HPO:iea[2009-02-17]
     * OMIM:168605	#168605 PERRY SYNDROME;;PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0100785	OMIM:168605	TAS					P	HPO:skoehler[2012-10-17]
     * OMIM:168605	#168605 PERRY SYNDROME;;PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0000511	OMIM:168605	TAS					P	HPO:skoehler[2014-08-24]
     * OMIM:168605	#168605 PERRY SYNDROME;;PARKINSONISM WITH ALVEOLAR HYPOVENTILATION AND MENTAL DEPRESSION		HP:0000719	OMIM:168605	TAS					P	HPO:skoehler[2014-08-24]
     * OMIM:168605	PERRY SYNDROME		HP:0002145	OMIM:168605	IEA					P	HPO:skoehler[2018-10-08]
     *
     * OMIM:176807	PROSTATE CANCER		HP:0012125	OMIM:176807	TAS					P	HPO:probinson[2013-08-11]
     * OMIM:176807	#176807 PROSTATE CANCER		HP:0000006	OMIM:176807	TAS					I	HPO:skoehler[2013-08-18]
     *
     * OMIM:194070	WILMS TUMOR 1		HP:0000006	OMIM:194070	IEA					I	HPO:iea[2009-02-17]
     * OMIM:194070	WILMS TUMOR 1		HP:0001425	OMIM:194070	IEA					I	HPO:skoehler[2010-06-19]
     * OMIM:194070	WILMS TUMOR 1		HP:0001428	OMIM:194070	IEA					I	HPO:iea[2009-02-17]
     * OMIM:194070	WILMS TUMOR 1		HP:0002667	OMIM:194070	IEA					P	HPO:iea[2009-02-17]
     *
     * OMIM:605724	#605724 FANCONI ANEMIA, COMPLEMENTATION GROUP D1; FANCD1;;FAD1		HP:0003221	PMID:15070707	PCS		HPO:probinson[2013-01-09]
     * OMIM:605724	#605724 FANCONI ANEMIA, COMPLEMENTATION GROUP D1; FANCD1;;FAD1		HP:0001511	PMID:15070707	PCS		7/7			P	HPO:probinson[2013-03-24]
     * OMIM:605724	#605724 FANCONI ANEMIA, COMPLEMENTATION GROUP D1; FANCD1;;FAD1		HP:0002023	PMID:15070707	PCS		2/7			P	HPO:probinson[2013-03-24]
     * OMIM:605724	#605724 FANCONI ANEMIA, COMPLEMENTATION GROUP D1; FANCD1;;FAD1		HP:0000957	PMID:15070707	PCS		4/7			P	HPO:probinson[2013-03-24]
     * OMIM:605724	#605724 FANCONI ANEMIA, COMPLEMENTATION GROUP D1; FANCD1;;FAD1		HP:0000252	PMID:15070707	PCS		3/7			P	HPO:probinson[2013-03-24]
     * OMIM:605724	#605724 FANCONI ANEMIA, COMPLEMENTATION GROUP D1; FANCD1;;FAD1		HP:0009778	PMID:15070707	PCS		1/7			P	HPO:probinson[2013-03-24]
     * OMIM:605724	#605724 FANCONI ANEMIA, COMPLEMENTATION GROUP D1; FANCD1;;FAD1		HP:0004808	PMID:15070707	PCS		5/7			P	HPO:probinson[2013-03-24]
     * OMIM:605724	#605724 FANCONI ANEMIA, COMPLEMENTATION GROUP D1; FANCD1;;FAD1		HP:0006727	PMID:15070707	PCS		1/7			P	HPO:probinson[2013-03-24]
     * OMIM:605724	#605724 FANCONI ANEMIA, COMPLEMENTATION GROUP D1; FANCD1;;FAD1		HP:0001508	PMID:15070707	PCS		5/7			P	HPO:probinson[2013-03-24]
     * OMIM:605724	#605724 FANCONI ANEMIA, COMPLEMENTATION GROUP D1; FANCD1;;FAD1		HP:0000007	PMID:15070707	PCS		HPO:probinson[2013-12-14]
     * OMIM:605724	FANCONI ANEMIA, COMPLEMENTATION GROUP D1		HP:0004322	OMIM:605724	TAS				HPO:skoehler[2017-07-13]
     * OMIM:605724	FANCONI ANEMIA, COMPLEMENTATION GROUP D1		HP:0005528	OMIM:605724	TAS				HPO:skoehler[2017-07-13]
     *
     * OMIM:607641	NEURONOPATHY, DISTAL HEREDITARY MOTOR, TYPE VIIB		HP:0001605	OMIM:607641	IEA			HPO:iea[2009-02-17]
     * OMIM:607641	NEURONOPATHY, DISTAL HEREDITARY MOTOR, TYPE VIIB		HP:0002366	OMIM:607641	IEA			HPO:iea[2009-02-17]
     * OMIM:607641	NEURONOPATHY, DISTAL HEREDITARY MOTOR, TYPE VIIB		HP:0003677	OMIM:607641	IEA			HPO:iea[2009-02-17]
     * OMIM:607641	NEURONOPATHY, DISTAL HEREDITARY MOTOR, TYPE VIIB		HP:0007340	OMIM:607641	IEA			HPO:iea[2009-02-17]
     * OMIM:607641	NEURONOPATHY, DISTAL HEREDITARY MOTOR, TYPE VIIB		HP:0009130	OMIM:607641	IEA			HPO:iea[2009-02-17]
     * OMIM:607641	NEURONOPATHY, DISTAL HEREDITARY MOTOR, TYPE VIIB		HP:0010628	OMIM:607641	IEA			HPO:iea[2009-02-17]
     * OMIM:607641	NEURONOPATHY, DISTAL HEREDITARY MOTOR, TYPE VIIB		HP:0000006	OMIM:607641	TAS			HPO:probinson[2012-04-26]
     * OMIM:607641	NEURONOPATHY, DISTAL HEREDITARY MOTOR, TYPE VIIB		HP:0001605	OMIM:607641	TAS			HPO:probinson[2012-04-26]
     * OMIM:607641	NEURONOPATHY, DISTAL HEREDITARY MOTOR, TYPE VIIB		HP:0003693	OMIM:607641	TAS			HPO:probinson[2012-04-26]
     * OMIM:607641	NEURONOPATHY, DISTAL HEREDITARY MOTOR, TYPE VIIB		HP:0002460	OMIM:607641	TAS			HPO:probinson[2012-04-26]
     * OMIM:607641	NEURONOPATHY, DISTAL HEREDITARY MOTOR, TYPE VIIB		HP:0003581	OMIM:607641	TAS			HPO:probinson[2012-04-26]
     * OMIM:607641	#607641 NEURONOPATHY, DISTAL HEREDITARY MOTOR, TYPE VIIB; HMN7B;;HMN VIIB;;NEUROPATHY, DISTAL HEREDITARY MOTOR, TYPE VIIB;;
     *      DHMN7B;;NEUROPATHY, DISTAL HEREDITARY MOTOR, WITH VOCAL CORD PARALYSIS, TYPEVIIB;;LOWER MOTOR NEURON DISEASE, DYNACTIN TYPE
     *      HP:0030237	OMIM:607641	TAS					P	HPO:skoehler[2015-01-04]
     *
     * OMIM:612555	BREAST-OVARIAN CANCER, FAMILIAL, SUSCEPTIBILITY TO, 2; BROVCA2		HP:0000006	OMIM:612555	IEA		HPO:skoehler[2010-06-19]
     * OMIM:612555	BREAST-OVARIAN CANCER, FAMILIAL, SUSCEPTIBILITY TO, 2; BROVCA2		HP:0001426	OMIM:612555	IEA		HPO:skoehler[2010-06-19]
     * OMIM:612555	BREAST-OVARIAN CANCER, FAMILIAL, SUSCEPTIBILITY TO, 2; BROVCA2		HP:0003002	OMIM:612555	IEA		HPO:skoehler[2010-06-19]
     * OMIM:612555	BREAST-OVARIAN CANCER, FAMILIAL, SUSCEPTIBILITY TO, 2; BROVCA2		HP:0100615	OMIM:612555	IEA		HPO:skoehler[2018-10-08]
     *
     * OMIM:613029	#613029 GLIOMA SUSCEPTIBILITY 3; GLM3		HP:0009592	OMIM:613029	TAS					HPO:skoehler[2015-12-30]
     * OMIM:613029	#613029 GLIOMA SUSCEPTIBILITY 3; GLM3		HP:0012174	OMIM:613029	TAS					HPO:skoehler[2015-12-30]
     * OMIM:613029	#613029 GLIOMA SUSCEPTIBILITY 3; GLM3		HP:0002885	OMIM:613029	TAS					HPO:skoehler[2015-12-30]
     * OMIM:613029	GLIOMA SUSCEPTIBILITY 3		HP:0000007	OMIM:613029	TAS					I	HPO:skoehler[2017-07-13]
     *
     * OMIM:613347	#613347 PANCREATIC CANCER, SUSCEPTIBILITY TO, 2;;PNCA2		HP:0002894	OMIM:613347	TAS			HPO:probinson[2013-01-09]
     *
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0000006	PMID:27040688	PCS				HPO:probinson[2017-06-25]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0003474	PMID:27040688	PCS				HPO:probinson[2017-06-25]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0002021	PMID:27040688	PCS				HPO:probinson[2017-06-25]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0003198	PMID:27040688	PCS				HPO:probinson[2017-06-25]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0003805	PMID:27040688	PCS				HPO:probinson[2017-06-25]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0007340	PMID:27040688	PCS		4/4		HPO:probinson[2017-06-25]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0003390	PMID:27040688	PCS				HPO:probinson[2017-06-25]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0002515	PMID:27040688	PCS				HPO:probinson[2017-06-25]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0003557	PMID:27040688	PCS				HPO:probinson[2017-06-25]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0003555	PMID:27040688	PCS				HPO:probinson[2017-06-25]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0003200	PMID:27040688	PCS				HPO:probinson[2017-06-25]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0009129	PMID:27040688	PCS		3/4		HPO:probinson[2017-06-25]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0007210	PMID:27040688	PCS		4/4		HPO:probinson[2017-06-25]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0002495	PMID:27040688	PCS		2/4		HPO:probinson[2017-06-25]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0003487	PMID:27040688	PCS		4/4		HPO:probinson[2017-06-25]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0003236	PMID:27040688	PCS		3/4		HPO:probinson[2017-06-25]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0003484	PMID:27040688	PCS		3/4		HPO:probinson[2017-06-25]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0003445	PMID:27040688	PCS		4/4		HPO:probinson[2017-06-25]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0003676	OMIM:616924	TAS				HPO:skoehler[2017-07-13]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0003828	OMIM:616924	TAS				HPO:skoehler[2017-07-13]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0003701	OMIM:616924	TAS		HP:0040283	HPO:skoehler[2017-07-13]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0002359	OMIM:616924	TAS				HPO:skoehler[2017-07-13]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0002936	OMIM:616924	TAS				HPO:skoehler[2017-07-13]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0001265	OMIM:616924	TAS				HPO:skoehler[2017-07-13]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC		HP:0001761	OMIM:616924	TAS				HPO:skoehler[2017-07-13]
     * OMIM:616924	CHARCOT-MARIE-TOOTH DISEASE, AXONAL, TYPE 2CC; CMT2CC		HP:0007141	OMIM:616924	IEA			HPO:skoehler[2018-10-08]
     *
     * HP:0000006, HP:0000007, HP:0001425, HP:0001426, HP:0001428 are modes of inheritance, not phenotypes
     * HP:0003581, HP:0003676, HP:0003677, HP:0003678 fall under clinical course, not phenotypes
     * HP:0003828, HP:0003829 are clinical modifiers, not phenotypes
     *
     * total of distinct phenotypes = 81
     */

    @Test
    public void countAndReportTest() throws IOException {
        Set<TermId> genes = new HashSet<>(CARDINALITY);
        genes.add(TermId.of("ENTREZ","675"));
        genes.add(TermId.of("ENTREZ","1639"));
        genes.add(TermId.of("ENTREZ","4744"));
        genes.add(TermId.of("ENTREZ","5630"));
        genes.add(TermId.of("ENTREZ","6647"));
        int[] counts = ctr.countAndReport(genes, "Test set");
        assertEquals("NUM_DISEASE_GENES is " + counts[NUM_DISEASE_GENES] + ", should be 5.",
                5, counts[NUM_DISEASE_GENES]);
        assertEquals("NUM_DISEASES is " + counts[NUM_DISEASES] + ", should be 12.",
                12, counts[NUM_DISEASES]);
        assertEquals("NUM_PHENOTYES is " + counts[NUM_PHENOTYPES] + ", should be 81.",
                81, counts[NUM_PHENOTYPES]);
    }
}
